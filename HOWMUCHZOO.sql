CREATE TABLE MONEY(
	HANDMONEY NUMBER
);

SELECT HANDMONEY FROM MONEY;

CREATE TABLE COW(
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM COW;

CREATE TABLE PIG(
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM PIG;

CREATE TABLE DOG(
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM DOG;

CREATE TABLE CAT(
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM CAT;

INSERT INTO MONEY
VALUES (10000);

SELECT HANDMONEY FROM MONEY;

COMMIT;

DROP TABLE CAT CASCADE CONSTRAINTS;
DROP TABLE DOG CASCADE CONSTRAINTS;
DROP TABLE PIG CASCADE CONSTRAINTS;
DROP TABLE COW CASCADE CONSTRAINTS;


CREATE TABLE COW(
	ANIMAL_TYPE NUMBER DEFAULT 1,
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM COW;

CREATE TABLE PIG(
	ANIMAL_TYPE NUMBER DEFAULT 2,
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM PIG;

CREATE TABLE DOG(
	ANIMAL_TYPE NUMBER DEFAULT 3,
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM DOG;

CREATE TABLE CAT(
	ANIMAL_TYPE NUMBER DEFAULT 4,
	SELL_DATE DATE DEFAULT SYSDATE,
	POINT NUMBER NOT NULL,
	PRICE NUMBER NOT NULL
);

SELECT * FROM CAT;

INSERT INTO COW
VALUES(DEFAULT, DEFAULT, 80, 15000);

INSERT INTO PIG
VALUES(DEFAULT, DEFAULT, 80, 8000);

INSERT INTO DOG
VALUES(DEFAULT, DEFAULT, 80, 3500);

INSERT INTO CAT
VALUES(DEFAULT, DEFAULT, 80, 3500);

COMMIT;

SELECT * FROM CAT;

UPDATE MONEY SET
HANDMONEY = HANDMONEY + 91000;

SELECT * FROM MONEY;

ROLLBACK;

SELECT * FROM COW;
SELECT * FROM PIG;
SELECT * FROM DOG;
SELECT * FROM CAT;

-- 한가지 순위
SELECT ROWNUM, DECODE(ANIMAL_TYPE, 1, '소', 2, '돼지', 3, '강아지', 4, '고양이') AS TYPE, 
POINT, PRICE, TO_CHAR(SELL_DATE, 'YY/MM/DD HH24:MI') AS RECORD
FROM(SELECT ANIMAL_TYPE, SELL_DATE, POINT, PRICE
FROM CAT
ORDER BY POINT DESC
);

-- 전체 순위
SELECT ROWNUM, DECODE(ANIMAL_TYPE, 1, '소', 2, '돼지', 3, '강아지', 4, '고양이') AS TYPE, 
POINT, PRICE, TO_CHAR(SELL_DATE, 'YY/MM/DD HH24:MI') AS RECORD
FROM(
SELECT ANIMAL_TYPE, SELL_DATE, POINT, PRICE
FROM COW
UNION
SELECT ANIMAL_TYPE, SELL_DATE, POINT, PRICE
FROM PIG
UNION
SELECT ANIMAL_TYPE, SELL_DATE, POINT, PRICE
FROM DOG
UNION
SELECT ANIMAL_TYPE, SELL_DATE, POINT, PRICE
FROM CAT
ORDER BY POINT DESC
);


DELETE FROM COW
WHERE ANIMAL_TYPE = 1;
DELETE FROM PIG
WHERE ANIMAL_TYPE = 2;
DELETE FROM DOG
WHERE ANIMAL_TYPE = 3;
DELETE FROM CAT
WHERE ANIMAL_TYPE = 4;

COMMIT;


























